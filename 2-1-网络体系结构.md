# 2. 网络体系结构

## 网络体系结构

层、服务、协议之间的集合

### 分层范例

#### 优点

- 每层独立
- 灵活性好
- 结构上下分开
- 易于实现和维护
- 促进标准化

#### 分层原则

- 根据功能进行分层
- 每层的功能明确
- 每层的功能和选择有利于指定国际标准
- 每层的接口信息量尽可能少
- 层数足够多：避免不同的功能混于同一层
- 层数不能太多：避免体系结构过于庞大

### 研究方法

-  按功能抽象分层
-  定义层间的接口和提供的服务
-  同层间通信的规则 —— 协议

### 实际学习研究思路

1. 选取模板（范例）      ISO/OSI  抽象五层
	- 分层
	- 服务
2. 实例                TCP/IP 协议集
	- 层次与模板的对应关系
	- 协议分析（核心）
## 层、协议、接口
### 层设计主题

- 编址机制
- 数据传输
- 差错控制
	- 差错的检测：每层都要做，每一种检测方式都不能保证检测出来，层间可能出错，上层也可能出错
	- 差错的恢复（可选）
- 顺序控制：保证不会缺失，重复等。保证正确的数据才会传给上层
- 流量控制：解决收发方处理能力不匹配的问题
- 拆分与重组：每个网络的 MTU（最大传输单元）不同
- 复用与解复用
- 路由
### 描述方法

#### 实体和对等实体

每一层都是落实到实体来实现的。

对等实体：位于不同子系统的相同层级的实体间的互称

#### 层和相邻层

- （n）层：网络体系结构中某特定层
- （n+1）层：其上层
- （n-1）层：其下层
- 每层实体与同一系统的相邻实体交互
- 每层实体与不同系统的对等实体交互

#### 协议

计算机网络的同等层次中，通信双方进行信息交换时必须遵守的规则

- 语法：以二进制形式表示的命令和相应的结构
- 语义：由发出的命令请求，完成的动作和回送的响应组成的集合
- 时序：有关事件顺序的说明

#### (n)连接

-  (n+1)实体利用(n)实体而建立的联系
-  (n+1)层对等实体要进行通信必须通过相邻下层以及下面各层通信来完成

#### 接口和服务

- 计算机网络分层结构中，每一层功能的本质都是为它的上层**提供服务**

### 服务

(n)实体向(n+1)实体提供的相互通信的能力，服务是一个垂直的概念

服务是(n+1)实体能看到的(n)实体提供的功能集合，包括：

- (n)实体自己提供的某些功能
- 从(n-1)层以及以下各层及本地系统得到的服务
- 通过与对等实体通信而得到的功能

#### 服务访问点（Service Access Point）

- 任何层间的服务都是在接口的服务访问点上进行的
- 每个服务访问点有唯一的识别地址
- 每个层间接口可以有多个服务访问点

#### 数据单元

在网络中信息传递的单位

- 对等实体在协议的控制下交换信息
- 相邻层实体按服务交换信息

数据单元包括

##### 协议数据单元 PDU

不同系统对等实体为实现该层协议所交换的信息单位

格式单位

PCI| 用户数据
---|--------

- PCI（协议控制信息）是为实现协议而在传送的数据的首部或者尾部加的控制信息，例如：地址、差错控制信息、序号信息
- 用户数据为提供服务而传送的信息
- 考虑到协议的要求，如时延，效率等因素，PDU大小一般有限制

##### 接口数据单元 IDU

同一系统的相邻实体的一次交互中，经过层间接口的信息单元

格式

ICI | 接口数据
----|---------

- ICI（接口控制信息）是协议在通过层间接口时，添加的一些控制信息，如通过多少字节，或要求的 Qos
- ICI 只对 PDU 通过接口时有作用
- 接口数据为通过接口进行传动的信息内容

##### 服务数据单元 SDU

上层服务用户所要求传递的数据单元

#### 服务分类

##### 面向（基于）连接的服务

- 传送数据时，首先建立连接，然后使用该连接传送数据。使用完后，关闭连接。
- 特点：可靠，顺序性好

##### 无连接服务

- 直接使用服务器传送数据，每个包独立进行路由选择。
- 特点：不可靠，顺序性差

#### 服务原语

服务在形式上是由一组**接口原语**（或操作）来描述的

- 当（n+1）实体向（n）实体请求（n）服务的时候，服务提供者和服务用户间需要交流一些必要信息，以说明要求的服务的一些情况，这些信息就是服务原语

OSI 中服务原语的类型

- 请求
- 指示
- 响应
- 确认


